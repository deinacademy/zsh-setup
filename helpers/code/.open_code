#!/bin/bash

while getopts ":f:p:i:n:" opt; do
    case $opt in
        f) file="${OPTARG}"
        ;;
        p) profile="${OPTARG}"
        ;;
        i) insiders=""
        ;;
        n) new=""
        ;;
        \?) echo "Invalid option -${OPTARG}" >&2
        exit 1
    esac
done

if [[ "$@" =~ "-n" ]]; then
    new="--new-window "
fi

if [[ -n "$profile" ]]; then
    profile="--profile ${profile} "
fi

path=""
if [[ -z "$file" ]]; then
    path="$( get_current_path )"
else
    path="$file"
fi

app="code"
if [[ "$@" =~ "-i" ]]; then
    app="code-insiders"
fi

run_cmd "${app} ${new}${profile}${path}"
